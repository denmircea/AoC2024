#include <iostream>
#include <fstream>
#include <algorithm>
#include <vector>
#include <map>
#include <set>
#include <unordered_map>

using namespace std;

ifstream fin("test.in");
ifstream fin2("test2.in");
vector<long long> v;

long long countcif(long long x) {
	long long cnt = 0;
	if (x < 10) {
		return 1;
	}
	while (x) {
		cnt++;
		x /= 10;
	}
	return cnt;
}

pair<long long, long long> splitnumberin2(long long x) {
	long long nrcif = countcif(x);
	long long nrcif1 = nrcif / 2;
	long long nrcif2 = nrcif - nrcif1;
	
	long long pow10 = 1;
	for (long long i = 1;i <= nrcif2;i++) {
		pow10 *= 10;
	}
	long long x1 = x / pow10;
	long long x2 = x % pow10;
	return { x1,x2 };
}
int tests = 75;
int main() {
	long long x;
	while (fin >> x) {
		v.push_back(x);
	}
	map<pair<long long, long long>, long long> mapa;
	long long nr, epoch, sz;
	while (fin2 >> nr >> epoch >> sz) {
		mapa[{nr, epoch}] = sz;
	}
	long long solution=0;
	for (long long test = 1;test <= tests;test++) {
		vector<long long> v2;
		for (auto it : v) {
		
			if (tests -test+1 <= 37 && it < 10) {
				long long rem = tests - test +2;
				solution += mapa[{it, rem}];
				//cout << solution << endl;
				continue;
			}
			if (it == 0) {
				v2.push_back(1);
				continue;
			}
			long long nrcif = countcif(it);
			if (nrcif % 2 == 0) {
				auto r1 = splitnumberin2(it);
				v2.push_back(r1.first);
				v2.push_back(r1.second);
			}
			else {

				v2.push_back(it * 2024LL);
			}
			
		}
		cout << test << " " << v.size() << endl;
		v = v2;
		v2.clear();
	}
	cout << solution + v.size()  << endl;
	return 0;
}

/// precomputed from file2
//0 1 1
//0 2 1
//0 3 1
//0 4 2
//0 5 4
//0 6 4
//0 7 7
//0 8 14
//0 9 16
//0 10 20
//0 11 39
//0 12 62
//0 13 81
//0 14 110
//0 15 200
//0 16 328
//0 17 418
//0 18 667
//0 19 1059
//0 20 1546
//0 21 2377
//0 22 3572
//0 23 5602
//0 24 8268
//0 25 12343
//0 26 19778
//0 27 29165
//0 28 43726
//0 29 67724
//0 30 102131
//0 31 156451
//0 32 234511
//0 33 357632
//0 34 549949
//0 35 819967
//0 36 1258125
//0 37 1916299
//0 38 2886408
//0 39 4414216
//0 40 6669768
//0 41 10174278
//0 42 15458147
//0 43 23333796
//0 44 35712308
//0 45 54046805
//0 46 81997335
//1 1 1
//1 2 1
//1 3 2
//1 4 4
//1 5 4
//1 6 7
//1 7 14
//1 8 16
//1 9 20
//1 10 39
//1 11 62
//1 12 81
//1 13 110
//1 14 200
//1 15 328
//1 16 418
//1 17 667
//1 18 1059
//1 19 1546
//1 20 2377
//1 21 3572
//1 22 5602
//1 23 8268
//1 24 12343
//1 25 19778
//1 26 29165
//1 27 43726
//1 28 67724
//1 29 102131
//1 30 156451
//1 31 234511
//1 32 357632
//1 33 549949
//1 34 819967
//1 35 1258125
//1 36 1916299
//1 37 2886408
//1 38 4414216
//1 39 6669768
//1 40 10174278
//1 41 15458147
//1 42 23333796
//1 43 35712308
//1 44 54046805
//2 1 1
//2 2 1
//2 3 2
//2 4 4
//2 5 4
//2 6 6
//2 7 12
//2 8 16
//2 9 19
//2 10 30
//2 11 57
//2 12 92
//2 13 111
//2 14 181
//2 15 295
//2 16 414
//2 17 661
//2 18 977
//2 19 1501
//2 20 2270
//2 21 3381
//2 22 5463
//2 23 7921
//2 24 11819
//2 25 18712
//2 26 27842
//2 27 42646
//2 28 64275
//2 29 97328
//2 30 150678
//2 31 223730
//2 32 343711
//2 33 525238
//2 34 784952
//2 35 1208065
//2 36 1824910
//2 37 2774273
//2 38 4230422
//2 39 6365293
//2 40 9763578
//2 41 14777945
//2 42 22365694
//3 1 1
//3 2 1
//3 3 2
//3 4 4
//3 5 4
//3 6 5
//3 7 10
//3 8 16
//3 9 26
//3 10 35
//3 11 52
//3 12 79
//3 13 114
//3 14 202
//3 15 294
//3 16 401
//3 17 642
//3 18 987
//3 19 1556
//3 20 2281
//3 21 3347
//3 22 5360
//3 23 7914
//3 24 12116
//3 25 18714
//3 26 27569
//3 27 42628
//3 28 64379
//3 29 98160
//3 30 150493
//3 31 223231
//3 32 344595
//3 33 524150
//3 34 788590
//3 35 1210782
//3 36 1821382
//3 37 2779243
//3 38 4230598
//3 39 6382031
//3 40 9778305
//3 41 14761601
//4 1 1
//4 2 1
//4 3 2
//4 4 4
//4 5 4
//4 6 4
//4 7 8
//4 8 16
//4 9 27
//4 10 30
//4 11 47
//4 12 82
//4 13 115
//4 14 195
//4 15 269
//4 16 390
//4 17 637
//4 18 951
//4 19 1541
//4 20 2182
//4 21 3204
//4 22 5280
//4 23 7721
//4 24 11820
//4 25 17957
//4 26 26669
//4 27 41994
//4 28 62235
//4 29 95252
//4 30 146462
//4 31 216056
//4 32 336192
//4 33 508191
//4 34 766555
//4 35 1178119
//4 36 1761823
//4 37 2709433
//4 38 4110895
//4 39 6188994
//4 40 9515384
//4 41 14316637
//5 1 1
//5 2 1
//5 3 1
//5 4 2
//5 5 4
//5 6 8
//5 7 8
//5 8 11
//5 9 22
//5 10 32
//5 11 45
//5 12 67
//5 13 109
//5 14 163
//5 15 223
//5 16 383
//5 17 597
//5 18 808
//5 19 1260
//5 20 1976
//5 21 3053
//5 22 4529
//5 23 6675
//5 24 10627
//5 25 15847
//5 26 23822
//5 27 37090
//5 28 55161
//5 29 84208
//5 30 128121
//5 31 194545
//5 32 298191
//5 33 444839
//5 34 681805
//5 35 1042629
//5 36 1565585
//5 37 2396146
//5 38 3626619
//5 39 5509999
//5 40 8396834
//5 41 12678459
//5 42 19375816
//6 1 1
//6 2 1
//6 3 1
//6 4 2
//6 5 4
//6 6 8
//6 7 8
//6 8 11
//6 9 22
//6 10 32
//6 11 54
//6 12 68
//6 13 103
//6 14 183
//6 15 250
//6 16 401
//6 17 600
//6 18 871
//6 19 1431
//6 20 2033
//6 21 3193
//6 22 4917
//6 23 7052
//6 24 11371
//6 25 16815
//6 26 25469
//6 27 39648
//6 28 57976
//6 29 90871
//6 30 136703
//6 31 205157
//6 32 319620
//6 33 473117
//6 34 727905
//6 35 1110359
//6 36 1661899
//6 37 2567855
//6 38 3849988
//6 39 5866379
//6 40 8978479
//6 41 13464170
//7 1 1
//7 2 1
//7 3 1
//7 4 2
//7 5 4
//7 6 8
//7 7 8
//7 8 11
//7 9 22
//7 10 32
//7 11 52
//7 12 72
//7 13 106
//7 14 168
//7 15 242
//7 16 413
//7 17 602
//7 18 832
//7 19 1369
//7 20 2065
//7 21 3165
//7 22 4762
//7 23 6994
//7 24 11170
//7 25 16509
//7 26 25071
//7 27 39034
//7 28 57254
//7 29 88672
//7 30 134638
//7 31 203252
//7 32 312940
//7 33 465395
//7 34 716437
//7 35 1092207
//7 36 1637097
//7 37 2519878
//7 38 3794783
//7 39 5771904
//7 40 8814021
//7 41 13273744
//8 1 1
//8 2 1
//8 3 1
//8 4 2
//8 5 4
//8 6 7
//8 7 7
//8 8 11
//8 9 22
//8 10 31
//8 11 48
//8 12 69
//8 13 103
//8 14 161
//8 15 239
//8 16 393
//8 17 578
//8 18 812
//8 19 1322
//8 20 2011
//8 21 3034
//8 22 4580
//8 23 6798
//8 24 10738
//8 25 16018
//8 26 24212
//8 27 37525
//8 28 55534
//8 29 85483
//8 30 130183
//8 31 196389
//8 32 301170
//8 33 450896
//8 34 691214
//8 35 1054217
//8 36 1583522
//8 37 2428413
//8 38 3669747
//8 39 5573490
//8 40 8505207
//8 41 12835708
//8 42 19605147
//9 1 1
//9 2 1
//9 3 1
//9 4 2
//9 5 4
//9 6 8
//9 7 8
//9 8 11
//9 9 22
//9 10 32
//9 11 54
//9 12 70
//9 13 103
//9 14 183
//9 15 262
//9 16 419
//9 17 586
//9 18 854
//9 19 1468
//9 20 2131
//9 21 3216
//9 22 4888
//9 23 7217
//9 24 11617
//9 25 17059
//9 26 25793
//9 27 40124
//9 28 58820
//9 29 92114
//9 30 139174
//9 31 208558
//9 32 322818
//9 33 480178
//9 34 740365
//9 35 1126352
//9 36 1685448
//9 37 2602817
//9 38 3910494
//9 39 5953715
//9 40 9102530
//9 41 13675794
//9 42 20970437
